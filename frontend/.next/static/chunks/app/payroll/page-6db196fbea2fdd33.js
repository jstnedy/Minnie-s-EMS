(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[88],{1423:(e,a,s)=>{"use strict";s.d(a,{PayrollClient:()=>r});var l=s(5155),t=s(2115);function r(e){let{canFinalize:a}=e,s=new Date,[r,n]=(0,t.useState)(s.getMonth()+1),[i,c]=(0,t.useState)(s.getFullYear()),[o,d]=(0,t.useState)(""),[m,h]=(0,t.useState)([]);async function x(){let e=await fetch("/api/payroll/compute?month=".concat(r,"&year=").concat(i),{method:"POST"}),a=await e.json();if(!e.ok)return void alert(a.error||"Unable to compute");d(a.run.id),h(a.items)}async function p(){let e=await fetch("/api/payroll/finalize",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({payrollRunId:o})});if(!e.ok)return void alert((await e.json()).error||"Unable to finalize");alert("Payroll finalized")}return(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsxs)("div",{className:"card flex flex-wrap items-end gap-3",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"text-sm",children:"Month"}),(0,l.jsx)("input",{className:"field",type:"number",min:1,max:12,value:r,onChange:e=>n(Number(e.target.value))})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"text-sm",children:"Year"}),(0,l.jsx)("input",{className:"field",type:"number",value:i,onChange:e=>c(Number(e.target.value))})]}),(0,l.jsx)("button",{className:"btn-primary",onClick:x,children:"Compute"}),(0,l.jsx)("button",{className:"btn-secondary",onClick:function(){window.location.href="/api/payroll/export?month=".concat(r,"&year=").concat(i)},children:"Export CSV"}),a?(0,l.jsx)("button",{className:"btn-primary",onClick:p,disabled:!o,children:"Finalize"}):null]}),(0,l.jsx)("div",{className:"card overflow-x-auto",children:(0,l.jsxs)("table",{className:"w-full text-sm",children:[(0,l.jsx)("thead",{children:(0,l.jsxs)("tr",{className:"border-b border-slate-200 text-left",children:[(0,l.jsx)("th",{className:"py-2",children:"Employee"}),(0,l.jsx)("th",{className:"py-2",children:"Shifts"}),(0,l.jsx)("th",{className:"py-2",children:"Hours"}),(0,l.jsx)("th",{className:"py-2",children:"Base"}),(0,l.jsx)("th",{className:"py-2",children:"Adjustments"}),(0,l.jsx)("th",{className:"py-2",children:"Net"})]})}),(0,l.jsx)("tbody",{children:m.map(e=>(0,l.jsxs)("tr",{className:"border-b border-slate-100",children:[(0,l.jsxs)("td",{className:"py-2",children:[e.employee.employeeId," - ",e.employee.fullName]}),(0,l.jsx)("td",{className:"py-2",children:e.totalShifts}),(0,l.jsx)("td",{className:"py-2",children:e.totalHours}),(0,l.jsxs)("td",{className:"py-2",children:["$",Number(e.basePay).toFixed(2)]}),(0,l.jsxs)("td",{className:"py-2",children:["$",Number(e.adjustmentsTotal).toFixed(2)]}),(0,l.jsxs)("td",{className:"py-2",children:["$",Number(e.netPay).toFixed(2)]})]},e.id))})]})})]})}},2653:(e,a,s)=>{Promise.resolve().then(s.bind(s,4567)),Promise.resolve().then(s.bind(s,1423))},4567:(e,a,s)=>{"use strict";s.d(a,{AppNav:()=>i});var l=s(5155),t=s(2619),r=s.n(t),n=s(6489);function i(e){let{role:a}=e,s=[{href:"/dashboard",label:"Dashboard",roles:["ADMIN","SUPERVISOR"]},{href:"/employees",label:"Employees",roles:["ADMIN","SUPERVISOR"]},{href:"/attendance",label:"Attendance",roles:["ADMIN","SUPERVISOR"]},{href:"/payroll",label:"Payroll",roles:["ADMIN","SUPERVISOR"]},{href:"/me",label:"My Records",roles:["ADMIN","SUPERVISOR","EMPLOYEE"]}].filter(e=>e.roles.includes(a));return(0,l.jsx)("div",{className:"sticky top-0 z-10 border-b border-orange-100 bg-white",children:(0,l.jsxs)("div",{className:"mx-auto flex max-w-6xl items-center justify-between px-4 py-3",children:[(0,l.jsx)("div",{className:"text-lg font-semibold text-orange-700",children:"Pastry Pal"}),(0,l.jsxs)("nav",{className:"flex items-center gap-3",children:[s.map(e=>(0,l.jsx)(r(),{href:e.href,className:"text-sm text-slate-700 hover:text-orange-700",children:e.label},e.href)),(0,l.jsx)("button",{className:"btn-secondary",onClick:()=>(0,n.signOut)({callbackUrl:"/login"}),children:"Logout"})]})]})})}}},e=>{e.O(0,[489,619,441,255,358],()=>e(e.s=2653)),_N_E=e.O()}]);